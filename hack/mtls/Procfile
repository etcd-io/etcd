# 3-node etcd cluster with full mTLS and CA reload enabled
# Run: goreman -f Procfile start

etcd1: ../../bin/etcd --name infra1 --listen-client-urls https://localhost:2379 --advertise-client-urls https://localhost:2379 --listen-peer-urls https://localhost:2380 --initial-advertise-peer-urls https://localhost:2380 --initial-cluster-token etcd-cluster-1 --initial-cluster 'infra1=https://localhost:2380,infra2=https://localhost:12380,infra3=https://localhost:22380' --initial-cluster-state new --cert-file=certs/etcd1.pem --key-file=certs/etcd1-key.pem --trusted-ca-file=certs/ca.pem --client-cert-auth --peer-cert-file=certs/etcd1.pem --peer-key-file=certs/etcd1-key.pem --peer-trusted-ca-file=certs/ca.pem --peer-client-cert-auth --peer-tls-reload-ca --client-tls-reload-ca --tls-ca-reload-interval=3s

etcd2: ../../bin/etcd --name infra2 --listen-client-urls https://localhost:12379 --advertise-client-urls https://localhost:12379 --listen-peer-urls https://localhost:12380 --initial-advertise-peer-urls https://localhost:12380 --initial-cluster-token etcd-cluster-1 --initial-cluster 'infra1=https://localhost:2380,infra2=https://localhost:12380,infra3=https://localhost:22380' --initial-cluster-state new --cert-file=certs/etcd2.pem --key-file=certs/etcd2-key.pem --trusted-ca-file=certs/ca.pem --client-cert-auth --peer-cert-file=certs/etcd2.pem --peer-key-file=certs/etcd2-key.pem --peer-trusted-ca-file=certs/ca.pem --peer-client-cert-auth --peer-tls-reload-ca --client-tls-reload-ca --tls-ca-reload-interval=3s

etcd3: ../../bin/etcd --name infra3 --listen-client-urls https://localhost:22379 --advertise-client-urls https://localhost:22379 --listen-peer-urls https://localhost:22380 --initial-advertise-peer-urls https://localhost:22380 --initial-cluster-token etcd-cluster-1 --initial-cluster 'infra1=https://localhost:2380,infra2=https://localhost:12380,infra3=https://localhost:22380' --initial-cluster-state new --cert-file=certs/etcd3.pem --key-file=certs/etcd3-key.pem --trusted-ca-file=certs/ca.pem --client-cert-auth --peer-cert-file=certs/etcd3.pem --peer-key-file=certs/etcd3-key.pem --peer-trusted-ca-file=certs/ca.pem --peer-client-cert-auth --peer-tls-reload-ca --client-tls-reload-ca --tls-ca-reload-interval=3s
